app: Emacs

ingredients:
  package: emacs23
  dist: oldstable
  sources:
    - deb http://ftp.de.debian.org/debian/ oldstable main

script:
  - wget -c "https://raw.githubusercontent.com/probonopd/AppImages/master/recipes/meta/Emacs.AppRun" -O AppRun
  - chmod a+x AppRun
  - cp ./usr/share/applications/emacs23.desktop .
  - sed -i -e 's|/usr/bin/||g' emacs*.desktop
  - sed -i -e 's|^Name=.*|Name=Emacs|g' emacs*.desktop
  - sed -i -e 's|^Icon=.*|Icon=emacs23|g' emacs*.desktop
  - cp ./usr/share/icons/hicolor/128x128/apps/emacs23.png .
  - sed -i -e 's|/usr|././|g' usr/bin/emacs23-x
  - sed -i -e 's|/usr|././|g' usr/bin/emacs23
  - mkdir -p usr/local
  - ( cd usr/local/ ; ln -s ../share/ . )
  - mkdir -p ./usr/share/emacs/23.4/lib-src/
  - mv etc/ e
  - sed -i -e 's|/etc|../e|g' usr/bin/emacs23-x
  - sed -i -e 's|/etc|../e|g' usr/bin/emacs23
  - sed -i -e 's|/etc|../e|g'  ./usr/share/emacs/site-lisp/debian-startup.el
  - sed -i -e 's|/usr|././|g'  ./usr/share/emacs/site-lisp/debian-startup.el
