wget -q https://github.com/probonopd/AppImages/raw/master/functions.sh -O ./functions.sh
. ./functions.sh

APP=Terminix
LOWERAPP=${APP,,} 

URL=https://copr-be.cloud.fedoraproject.org/results/heikoada/terminix/epel-7-x86_64/00180528-terminix/terminix-0.58.1-1.el7.centos.x86_64.rpm

sudo apt-get -y install rpm2cpio

mkdir -p $APP/$APP.AppDir

cd $APP
wget -c "$URL"

cd $APP.AppDir

rpm2cpio ../*.rpm | cpio -idmv

cp ./usr/share/applications/com.gexperts.Terminix.desktop terminix.desktop
rm -rf usr/share/icons/hicolor/48x48/

get_apprun

find usr/ -type f -exec sed -i -e "s|/usr|././|g" {} \;

( mkdir -p usr/share/glib-2.0/schemas/ ; cd usr/share/glib-2.0/schemas/ ; glib-compile-schemas . )

VER1=$(ls ../terminix-*.rpm | head -n 1 | cut -d "-" -f 2)
GLIBC_NEEDED=$(glibc_needed)
VERSION=$VER1.glibc$GLIBC_NEEDED
echo $VERSION

get_desktopintegration $LOWERAPP

# Copy in the indirect dependencies
copy_deps ; copy_deps ; copy_deps # Three runs to ensure we catch indirect ones

move_lib

delete_blacklisted

# Go out of AppImage
cd ..

ARCH="x86_64"
generate_appimage
