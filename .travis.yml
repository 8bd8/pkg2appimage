sudo: required
services:
- docker
- notifications: false

env:
  - RECIPE=scribus
  - RECIPE=subsurface
  
before_install:
- # Install prerequisites for travis2github.py uploader
- wget -c https://raw.githubusercontent.com/probonopd/travis2github/master/travis2github.py
- wget -c https://raw.githubusercontent.com/probonopd/travis2github/master/magic.py
- sudo apt-get update -qq
- sudo apt-get install python-requests  python-chardet python-urllib3 python-six -qq
- ln -s /usr/lib/python2.7/dist-packages/six.py /usr/lib/python2.7/dist-packages/requests/ /usr/lib/python2.7/dist-packages/chardet/ /usr/lib/python2.7/dist-packages/urllib3/ .

script:
- mkdir -p ./out/
- wget https://raw.githubusercontent.com/probonopd/AppImages/master/recipes/$RECIPE/Recipe -O ./out/Recipe
- sed -i -e 's|sudo ||g' ./out/Recipe # For subsurface recipe
- docker run -i -v ${PWD}/out:/out probonopd/appimages:$RECIPE /bin/bash -ex /out/Recipe
- python travis2github.py out/*.AppImage
